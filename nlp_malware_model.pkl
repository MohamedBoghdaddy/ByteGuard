from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.linear_model import LogisticRegression
import joblib

# Sample dataset (replace with actual script content and labels)
scripts = ["safe script content", "malicious script content"]
labels = [0, 1]  # 0: benign, 1: malicious

# Step 1: Convert text data to TF-IDF features
vectorizer = TfidfVectorizer()
X = vectorizer.fit_transform(scripts)

# Step 2: Train a Logistic Regression model
model = LogisticRegression()
model.fit(X, labels)

# Step 3: Save the model and the vectorizer
joblib.dump(model, 'nlp_malware_model.pkl')
joblib.dump(vectorizer, 'tfidf_vectorizer.pkl')
